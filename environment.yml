# =============================================================================
# TechSDRF Conda Environment
# =============================================================================
#
# This environment contains all dependencies needed to run techsdrf,
# including raw file conversion tools for Thermo .raw files.
#
# Installation:
#   conda env create -f environment.yml
#
# Activation:
#   conda activate techsdrf
#
# Update existing environment:
#   conda env update -f environment.yml --prune
#
# Install techsdrf in development mode after activating:
#   pip install -e .
#
# =============================================================================

name: techsdrf

channels:
  - conda-forge
  - bioconda
  - defaults

dependencies:
  # ---------------------------------------------------------------------------
  # Python version (3.9-3.11 supported, 3.12 has compatibility issues)
  # ---------------------------------------------------------------------------
  - python>=3.9,<3.12

  # ---------------------------------------------------------------------------
  # Core scientific computing
  # ---------------------------------------------------------------------------
  - numpy>=1.21
  - scipy>=1.7
  - pandas>=1.3

  # ---------------------------------------------------------------------------
  # CLI framework
  # ---------------------------------------------------------------------------
  - click>=8.0

  # ---------------------------------------------------------------------------
  # MS file parsing (mzML)
  # ---------------------------------------------------------------------------
  - pyteomics>=4.5
  - lxml>=4.6

  # ---------------------------------------------------------------------------
  # Raw file conversion tools
  # ---------------------------------------------------------------------------
  # ThermoRawFileParser - converts Thermo .raw files to mzML
  # Requires mono runtime (automatically installed as dependency)
  - bioconda::thermorawfileparser>=1.4.2

  # Note: For Bruker (.d) and SCIEX (.wiff) files, msconvert from ProteoWizard
  # is needed. ProteoWizard is not available via conda on macOS/Linux.
  # Options:
  #   - Docker: docker run -v /data:/data proteowizard/pwiz-skyline-i-agree-to-the-vendor-licenses
  #   - Linux: Install via apt (Ubuntu) or download from proteowizard.sourceforge.io
  #   - macOS: Use Docker or Wine

  # ---------------------------------------------------------------------------
  # Network and file transfer
  # ---------------------------------------------------------------------------
  - requests>=2.28
  - tqdm>=4.64  # Progress bars for downloads

  # ---------------------------------------------------------------------------
  # Utilities
  # ---------------------------------------------------------------------------
  - python-dateutil>=2.8

  # ---------------------------------------------------------------------------
  # Development and testing
  # ---------------------------------------------------------------------------
  - pytest>=7.0
  - pytest-cov>=3.0
  - black>=22.0
  - isort>=5.10

  # ---------------------------------------------------------------------------
  # pip-only dependencies
  # ---------------------------------------------------------------------------
  - pip
  - pip:
      # SDRF parsing and validation
      - sdrf-pipelines>=0.0.25

      # PRIDE archive file downloads
      - pridepy>=0.0.4

      # Tolerance estimation (RunAssessor, Gaussian fitting)
      - runassessor
